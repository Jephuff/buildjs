const depcheck = require('depcheck');
const pify = require('pify');

const options = {
  ignoreBinPackage: false, // ignore the packages with bin entry
  ignoreDirs: ['lib', 'umd'],
  ignoreMatches: [],
  parsers: {
    '*.js': require('./parsers/es7'),
  },
  detectors: [
    depcheck.detector.requireCallExpression,
    depcheck.detector.importDeclaration,
  ],
  specials: [
    require('./specials/webpack'),
    require('./specials/eslint'),
  ],
};

module.exports = (d) => (
  // a lookup indicating each dependency is used by which files
  pify(depcheck)(d, options)
);
